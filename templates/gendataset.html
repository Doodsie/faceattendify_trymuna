{% include "header.html" %}
<style>
    #confirmationModal {
        display: flex;
        justify-content: center;
        align-items: center;
        background: rgba(0, 0, 0, 0.7);
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
    }

    #confirmationModal .modal-content {
        background: white;
        padding: 20px;
        border-radius: 5px;
        text-align: center;
        box-shadow: none;
    }

    #confirmationModal p {
        margin: 0 0 20px;
    }
</style>

<div class="content" style="background-color:white;">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="alert-messages">
                {% for category, message in messages %}
                    <div class="alert alert-success alert-{{ category }}" role="alert" style="text-align:center;">
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <div class="container-fluid">
        <section class="py-1">
            <div class="row mx-auto text-center">
                <div class="col-md-3-lg-2">
                    {% if not user_completed_process %}
                        <button onclick="startDataset()" id="addfacestart" class="btn btn-warning btn-lg">Start</button>
                        <button onclick="stopDataset()" style="display:none;" class="btn btn-danger btn-lg" id="addfacestop">Stop</button>
                        <a class="btn btn-success btn-lg" href="{{ url_for('train_classifier', nbr=prs) }}" id="training" style="display:none;"> Train Face</a>
                    {% endif %}
                </div>
            </div>
            <div class="row mt-5">
                <div class="col-md-3-lg-2 mx-auto text-center">
                    <h3><b>Generate Face</b></h3>
                    <hr>
                    <img width="25%" height="25%" class="img-thumbnail1" id="addfaceimg">
                    <h4>Please ensure that you are the only one in front of the camera.</h4>
                    <h4>Please ensure that you train your face in a good lighting condition.</h4>
                </div>
            </div>
        </section>
    </div>

    <!-- Modal Dialog -->
    <div id="confirmationModal" class="modal" style="display: none;">
        <div class="modal-content">
            <p>By clicking the "<b>AGREE</b>" button, you are expressly agreeing to our compliance with the Data Privacy Act of 2012. This act underscores our unwavering commitment to safeguarding the privacy and security of your personal information as it pertains to our Attendance Management System utilizing Facial Recognition. We adhere to stringent data protection measures, ensuring that your facial data is handled with the utmost care and in full compliance with the law. This agreement signifies your acknowledgment of our obligations and your trust in us to manage your data responsibly and securely.</p>
            <button id="okButton" class="btn btn-primary">Agree</button>
            <button id="cancelButton" class="btn btn-secondary">Cancel</button>
        </div>
    </div>
</div>

{% include "footer.html" %}

<script>
    function startDataset() {
        $('#addfaceimg').attr('src', '{{ url_for('video_feed', nbr=prs) }}');
        $('#addfaceimg').show();
        $('#addfacestart').hide();
        $('#addfacestop').show();
        $('#training').show();
    }

    function stopDataset() {
        $('#addfaceimg').attr('src', '');
        $('#addfaceimg').hide();
        $('#addfacestart').show();
        $('#addfacestop').hide();
    }

    // Handle the click event of the Train Face button
    $('#training').click(function (event) {
        event.preventDefault();
        $('#confirmationModal').css('display', 'block');
    });

    // Close the modal and prevent default action when "Cancel" is clicked
    $('#cancelButton').click(function () {
        $('#confirmationModal').css('display', 'none');
    });

    // Proceed with the action when "OK" is clicked
    $('#okButton').click(function () {
        $('#confirmationModal').css('display', 'none');
        window.location.href = "{{ url_for('train_classifier', nbr=prs) }}";
    });
</script>
